"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[477],{3933:function(t,e,r){r.d(e,{c_:function(){return g},kk:function(){return f},o3:function(){return d}});var n=r(1527),a=r(9300),o=r(4379),s=r(4157),i=r(6131),c=r(3125),u=r(959),l=r(4271);let d="token",f="tokenExpire",h=a.J.authPages;function g(){let[t,e]=(0,u.useState)(null),[r,g]=(0,u.useState)(""),[p,b]=(0,u.useState)(!0),v=(0,c.useRouter)(),{toast:m}=(0,o.pm)();(0,u.useEffect)(()=>{if(v.isReady){v.pathname==a.J.links.login&&b(!1);let t=i.Z.get(d);t&&e(t),k()}},[v.isReady]),(0,u.useEffect)(()=>{r&&m({variant:"destructive",title:"Auth error",description:r})},[r]);let k=()=>{for(let t of h)if(v.pathname.startsWith(t)){let t=i.Z.get(f),r=Date.parse(t)-Date.now();r<0?(i.Z.remove(d),i.Z.remove(f)):r<3600?s.t.GenrateToken({}).then(t=>{t.token?(i.Z.set(d,t.token,{expires:new Date(t.expiry)}),i.Z.set(f,t.expiry,{expires:new Date(t.expiry)}),e(t.token)):(g("Get token failed"),x())}).catch(t=>{g("Get token failed ".concat(t)),x()}):e(i.Z.get(d))}},y=()=>{i.Z.remove(d),i.Z.remove(f),v.push(a.J.links.home),v.reload()},x=()=>{v.push(a.J.links.login)};return(0,n.jsx)(n.Fragment,{children:(()=>{if(p)return t?(0,n.jsx)(l.z,{variant:"ghost",size:"sm",onClick:y,children:"Logout"}):(0,n.jsx)(l.z,{variant:"ghost",size:"sm",onClick:x,children:"Login"})})()})}},4271:function(t,e,r){r.d(e,{d:function(){return i},z:function(){return c}});var n=r(1527),a=r(959),o=r(1590),s=r(9140);let i=(0,o.j)("active:scale-95 inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 dark:hover:bg-slate-800 dark:hover:text-slate-100 disabled:opacity-50 dark:focus:ring-slate-400 disabled:pointer-events-none dark:focus:ring-offset-slate-900 data-[state=open]:bg-slate-100 dark:data-[state=open]:bg-slate-800",{variants:{variant:{default:"bg-slate-900 text-white hover:bg-slate-700 dark:bg-slate-50 dark:text-slate-900",destructive:"bg-red-500 text-white hover:bg-red-600 dark:hover:bg-red-600",outline:"bg-transparent border border-slate-200 hover:bg-slate-100 dark:border-slate-700 dark:text-slate-100",subtle:"bg-slate-100 text-slate-900 hover:bg-slate-200 dark:bg-slate-700 dark:text-slate-100",ghost:"bg-transparent hover:bg-slate-100 dark:hover:bg-slate-800 dark:text-slate-100 dark:hover:text-slate-100 data-[state=open]:bg-transparent dark:data-[state=open]:bg-transparent",link:"bg-transparent dark:bg-transparent underline-offset-4 hover:underline text-slate-900 dark:text-slate-100 hover:bg-transparent dark:hover:bg-transparent"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-2 rounded-md",lg:"h-11 px-8 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((t,e)=>{let{className:r,variant:a,size:o,...c}=t;return(0,n.jsx)("button",{className:(0,s.cn)(i({variant:a,size:o,className:r})),ref:e,...c})});c.displayName="Button"},4624:function(t,e,r){r.d(e,{I:function(){return s}});var n=r(1527),a=r(959),o=r(9140);let s=a.forwardRef((t,e)=>{let{className:r,...a}=t;return(0,n.jsx)("input",{className:(0,o.cn)("flex h-10 w-full rounded-md border border-slate-300 bg-transparent py-2 px-3 text-sm placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-700 dark:text-slate-50 dark:focus:ring-slate-400 dark:focus:ring-offset-slate-900",r),ref:e,...a})});s.displayName="Input"},9300:function(t,e,r){function n(t){return t+".html"}r.d(e,{J:function(){return a}});let a={name:"NotionBoy",description:"NotionBoy is a note app base on Notion. It's a web app, you can use it in your browser.",links:{twitter:"https://twitter.com/LiuVaayne",github:"https://github.com/vaayne/NotionBoy",chatgpt:n("/chat"),login:n("/login"),home:"/",authCallback:n("/authcallback")},authPages:[n("/chat")]}},4157:function(t,e,r){r.d(e,{t:function(){return l}});let n=Array(64),a=Array(123);for(let t=0;t<64;)a[n[t]=t<26?t+65:t<52?t+71:t<62?t-4:t-59|43]=t++;function o(t,e){return e&&e.constructor===Uint8Array?function(t,e,r){let a=null,o=[],s=0,i=0,c;for(;e<r;){let r=t[e++];switch(i){case 0:o[s++]=n[r>>2],c=(3&r)<<4,i=1;break;case 1:o[s++]=n[c|r>>4],c=(15&r)<<2,i=2;break;case 2:o[s++]=n[c|r>>6],o[s++]=n[63&r],i=0}s>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,o)),s=0)}return(i&&(o[s++]=n[c],o[s++]=61,1===i&&(o[s++]=61)),a)?(s&&a.push(String.fromCharCode.apply(String,o.slice(0,s))),a.join("")):String.fromCharCode.apply(String,o.slice(0,s))}(e,0,e.length):e}function s(t,e){let{pathPrefix:r,...n}=e||{},a=r?"".concat(r).concat(t):t;return fetch(a,n).then(t=>t.json().then(e=>{if(!t.ok)throw e;return e}))}async function i(t,e,r){var n;let{pathPrefix:a,...o}=r||{},s=a?"".concat(a).concat(t):t,i=await fetch(s,o);if(!i.ok){let t=await i.json(),e=t.error&&t.error.message?t.error.message:"";throw Error(e)}if(!i.body)throw Error("response doesnt have a body");await i.body.pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({start(t){t.buf="",t.pos=0},transform(t,e){for(void 0===e.buf&&(e.buf=""),void 0===e.pos&&(e.pos=0),e.buf+=t;e.pos<e.buf.length;)if("\n"===e.buf[e.pos]){let t=e.buf.substring(0,e.pos),r=JSON.parse(t);e.enqueue(r.result),e.buf=e.buf.substring(e.pos+1),e.pos=0}else++e.pos}})).pipeTo((n=t=>{e&&e(t)},new WritableStream({write(t){n(t)}})))}function c(t){return["string","number","boolean"].some(e=>typeof t===e)}function u(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=function t(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.keys(e).reduce((n,a)=>{let o=e[a],s=r?[r,a].join("."):a,i=Array.isArray(o)&&o.every(t=>c(t))&&o.length>0,u=c(o)&&!(!1===o||0===o||""===o),l={};return!function(t){let e="Object"===Object.prototype.toString.call(t).slice(8,-1);if(!(null!==t&&e)||!e)return!1;let r=Object.getPrototypeOf(t),n="object"==typeof r&&r.constructor===Object.prototype.constructor;return n}(o)?(u||i)&&(l={[s]:o}):l=t(o,s),{...n,...l}},{})}(t),n=Object.keys(r).reduce((t,n)=>{let a=r[n];return e.find(t=>t===n)?t:Array.isArray(a)?[...t,...a.map(t=>[n,t.toString()])]:t=[...t,[n,a.toString()]]},[]);return new URLSearchParams(n).toString()}class l{static Status(t,e){return s("/v1/status?".concat(u(t,[])),{...e,method:"GET"})}static GenrateToken(t,e){return s("/v1/auth/token",{...e,method:"POST",body:JSON.stringify(t,o)})}static OAuthProviders(t,e){return s("/v1/auth/providers?".concat(u(t,[])),{...e,method:"GET"})}static OAuthCallback(t,e){return s("/v1/auth/callback",{...e,method:"POST",body:JSON.stringify(t,o)})}static GenerateApiKey(t,e){return s("/v1/auth/apikey",{...e,method:"POST"})}static DeleteApiKey(t,e){return s("/v1/auth/apikey",{...e,method:"DELETE"})}static GenerateWechatQRCode(t,e){return s("/v1/auth/wechat/qrcode",{...e,method:"POST",body:JSON.stringify(t,o)})}static CreateConversation(t,e){return s("/v1/conversations",{...e,method:"POST",body:JSON.stringify(t,o)})}static UpdateConversation(t,e){return s("/v1/conversations/".concat(t.id),{...e,method:"PUT",body:JSON.stringify(t,o)})}static GetConversation(t,e){return s("/v1/conversations/".concat(t.id,"?").concat(u(t,["id"])),{...e,method:"GET"})}static ListConversations(t,e){return s("/v1/conversations?".concat(u(t,[])),{...e,method:"GET"})}static DeleteConversation(t,e){return s("/v1/conversations/".concat(t.id),{...e,method:"DELETE"})}static CreateMessage(t,e,r){return i("/v1/conversations/".concat(t.conversationId,"/messages"),e,{...r,method:"POST",body:JSON.stringify(t,o)})}static GetMessage(t,e){return s("/v1/conversations/".concat(t.conversationId,"/messages/").concat(t.id,"?").concat(u(t,["conversationId","id"])),{...e,method:"GET"})}static ListMessages(t,e){return s("/v1/conversations/".concat(t.conversationId,"/messages?").concat(u(t,["conversationId"])),{...e,method:"GET"})}static DeleteMessage(t,e){return s("/v1/conversations/".concat(t.conversationId,"/messages/").concat(t.id),{...e,method:"DELETE"})}}}}]);
