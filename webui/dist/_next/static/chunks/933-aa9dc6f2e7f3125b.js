"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[933],{3933:function(t,e,r){r.d(e,{c_:function(){return p},kk:function(){return h},o3:function(){return l}});var n=r(11527),o=r(49300),a=r(4379),s=r(44157),i=r(96131),c=r(73125),d=r(50959),u=r(64271);let l="token",h="tokenExpire",f=o.J.authPages;function p(){let[t,e]=(0,d.useState)(null),[r,p]=(0,d.useState)(""),[g,v]=(0,d.useState)(!0),b=(0,c.useRouter)(),{toast:m}=(0,a.pm)();(0,d.useEffect)(()=>{if(b.isReady){b.pathname==o.J.links.login&&v(!1);let t=i.Z.get(l);t&&e(t),y()}},[b]),(0,d.useEffect)(()=>{r&&m({variant:"destructive",title:"Auth error",description:r})},[r]);let y=()=>{for(let t of f)if(b.pathname.startsWith(t)){let t=i.Z.get(h),r=Date.parse(t)-Date.now();r<0?(i.Z.remove(l),i.Z.remove(h)):r<3600?s.t.GenrateToken({}).then(t=>{t.token?(i.Z.set(l,t.token,{expires:new Date(t.expiry)}),i.Z.set(h,t.expiry,{expires:new Date(t.expiry)}),e(t.token)):(p("Get token failed"),S())}).catch(t=>{p("Get token failed ".concat(t)),S()}):e(i.Z.get(l))}},k=()=>{i.Z.remove(l),i.Z.remove(h),b.push(o.J.links.home),b.reload()},S=()=>{b.push(o.J.links.login)};return(0,n.jsx)(n.Fragment,{children:(()=>{if(g)return t?(0,n.jsx)(u.z,{variant:"ghost",size:"sm",onClick:k,children:"Logout"}):(0,n.jsx)(u.z,{variant:"ghost",size:"sm",onClick:S,children:"Login"})})()})}},64271:function(t,e,r){r.d(e,{d:function(){return i},z:function(){return c}});var n=r(11527),o=r(50959),a=r(71590),s=r(29140);let i=(0,a.j)("active:scale-95 inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 dark:hover:bg-slate-800 dark:hover:text-slate-100 disabled:opacity-50 dark:focus:ring-slate-400 disabled:pointer-events-none dark:focus:ring-offset-slate-900 data-[state=open]:bg-slate-100 dark:data-[state=open]:bg-slate-800",{variants:{variant:{default:"bg-slate-900 text-white hover:bg-slate-700 dark:bg-slate-50 dark:text-slate-900",destructive:"bg-red-500 text-white hover:bg-red-600 dark:hover:bg-red-600",outline:"bg-transparent border border-slate-200 hover:bg-slate-100 dark:border-slate-700 dark:text-slate-100",subtle:"bg-slate-100 text-slate-900 hover:bg-slate-200 dark:bg-slate-700 dark:text-slate-100",ghost:"bg-transparent hover:bg-slate-100 dark:hover:bg-slate-800 dark:text-slate-100 dark:hover:text-slate-100 data-[state=open]:bg-transparent dark:data-[state=open]:bg-transparent",link:"bg-transparent dark:bg-transparent underline-offset-4 hover:underline text-slate-900 dark:text-slate-100 hover:bg-transparent dark:hover:bg-transparent"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-2 rounded-md",lg:"h-11 px-8 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),c=o.forwardRef((t,e)=>{let{className:r,variant:o,size:a,...c}=t;return(0,n.jsx)("button",{className:(0,s.cn)(i({variant:o,size:a,className:r})),ref:e,...c})});c.displayName="Button"},49300:function(t,e,r){function n(t){return t+".html"}r.d(e,{J:function(){return o}});let o={name:"NotionBoy",description:"NotionBoy is a note app base on Notion. It's a web app, you can use it in your browser.",links:{twitter:"https://twitter.com/LiuVaayne",github:"https://github.com/vaayne/NotionBoy",chatgpt:n("/chat"),login:n("/login"),home:"/",authCallback:n("/authcallback"),price:n("/price"),order:n("/order"),profile:n("/profile")},authPages:[n("/chat"),n("/order"),n("/user")]}},44157:function(t,e,r){r.d(e,{t:function(){return u}});let n=Array(64),o=Array(123);for(let t=0;t<64;)o[n[t]=t<26?t+65:t<52?t+71:t<62?t-4:t-59|43]=t++;function a(t,e){return e&&e.constructor===Uint8Array?function(t,e,r){let o=null,a=[],s=0,i=0,c;for(;e<r;){let r=t[e++];switch(i){case 0:a[s++]=n[r>>2],c=(3&r)<<4,i=1;break;case 1:a[s++]=n[c|r>>4],c=(15&r)<<2,i=2;break;case 2:a[s++]=n[c|r>>6],a[s++]=n[63&r],i=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return(i&&(a[s++]=n[c],a[s++]=61,1===i&&(a[s++]=61)),o)?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))}(e,0,e.length):e}function s(t,e){let{pathPrefix:r,...n}=e||{},o=r?"".concat(r).concat(t):t;return fetch(o,n).then(t=>t.json().then(e=>{if(!t.ok)throw e;return e}))}async function i(t,e,r){var n;let{pathPrefix:o,...a}=r||{},s=o?"".concat(o).concat(t):t,i=await fetch(s,a);if(!i.ok){let t=await i.json(),e=t.error&&t.error.message?t.error.message:"";throw Error(e)}if(!i.body)throw Error("response doesnt have a body");await i.body.pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({start(t){t.buf="",t.pos=0},transform(t,e){for(void 0===e.buf&&(e.buf=""),void 0===e.pos&&(e.pos=0),e.buf+=t;e.pos<e.buf.length;)if("\n"===e.buf[e.pos]){let t=e.buf.substring(0,e.pos),r=JSON.parse(t);e.enqueue(r.result),e.buf=e.buf.substring(e.pos+1),e.pos=0}else++e.pos}})).pipeTo((n=t=>{e&&e(t)},new WritableStream({write(t){n(t)}})))}function c(t){return["string","number","boolean"].some(e=>typeof t===e)}function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=function t(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.keys(e).reduce((n,o)=>{let a=e[o],s=r?[r,o].join("."):o,i=Array.isArray(a)&&a.every(t=>c(t))&&a.length>0,d=c(a)&&!(!1===a||0===a||""===a),u={};return!function(t){let e="Object"===Object.prototype.toString.call(t).slice(8,-1);if(!(null!==t&&e)||!e)return!1;let r=Object.getPrototypeOf(t),n="object"==typeof r&&r.constructor===Object.prototype.constructor;return n}(a)?(d||i)&&(u={[s]:a}):u=t(a,s),{...n,...u}},{})}(t),n=Object.keys(r).reduce((t,n)=>{let o=r[n];return e.find(t=>t===n)?t:Array.isArray(o)?[...t,...o.map(t=>[n,t.toString()])]:t=[...t,[n,o.toString()]]},[]);return new URLSearchParams(n).toString()}class u{static Status(t,e){return s("/v1/status?".concat(d(t,[])),{...e,method:"GET"})}static GenrateToken(t,e){return s("/v1/auth/token",{...e,method:"POST",body:JSON.stringify(t,a)})}static OAuthProviders(t,e){return s("/v1/auth/providers?".concat(d(t,[])),{...e,method:"GET"})}static OAuthCallback(t,e){return s("/v1/auth/callback",{...e,method:"POST",body:JSON.stringify(t,a)})}static GenerateApiKey(t,e){return s("/v1/auth/apikey",{...e,method:"POST"})}static DeleteApiKey(t,e){return s("/v1/auth/apikey",{...e,method:"DELETE"})}static GenerateWechatQRCode(t,e){return s("/v1/auth/wechat/qrcode",{...e,method:"POST",body:JSON.stringify(t,a)})}static CreateConversation(t,e){return s("/v1/conversations",{...e,method:"POST",body:JSON.stringify(t,a)})}static UpdateConversation(t,e){return s("/v1/conversations/".concat(t.id),{...e,method:"PUT",body:JSON.stringify(t,a)})}static GetConversation(t,e){return s("/v1/conversations/".concat(t.id,"?").concat(d(t,["id"])),{...e,method:"GET"})}static ListConversations(t,e){return s("/v1/conversations?".concat(d(t,[])),{...e,method:"GET"})}static DeleteConversation(t,e){return s("/v1/conversations/".concat(t.id),{...e,method:"DELETE"})}static CreateMessage(t,e,r){return i("/v1/conversations/".concat(t.conversationId,"/messages"),e,{...r,method:"POST",body:JSON.stringify(t,a)})}static GetMessage(t,e){return s("/v1/conversations/".concat(t.conversationId,"/messages/").concat(t.id,"?").concat(d(t,["conversationId","id"])),{...e,method:"GET"})}static ListMessages(t,e){return s("/v1/conversations/".concat(t.conversationId,"/messages?").concat(d(t,["conversationId"])),{...e,method:"GET"})}static DeleteMessage(t,e){return s("/v1/conversations/".concat(t.conversationId,"/messages/").concat(t.id),{...e,method:"DELETE"})}static CreateOrder(t,e){return s("/v1/orders",{...e,method:"POST",body:JSON.stringify(t,a)})}static GetOrder(t,e){return s("/v1/orders/".concat(t.id,"?").concat(d(t,["id"])),{...e,method:"GET"})}static ListOrders(t,e){return s("/v1/orders?".concat(d(t,[])),{...e,method:"GET"})}static DeleteOrder(t,e){return s("/v1/orders/".concat(t.id),{...e,method:"DELETE"})}static UpdateOrder(t,e){return s("/v1/orders/".concat(t.id),{...e,method:"PATCH",body:JSON.stringify(t,a)})}static PayOrder(t,e){return s("/v1/orders/".concat(t.id,"/pay"),{...e,method:"POST",body:JSON.stringify(t,a)})}static CreateProduct(t,e){return s("/v1/products",{...e,method:"POST",body:JSON.stringify(t,a)})}static GetProduct(t,e){return s("/v1/products/".concat(t.id,"?").concat(d(t,["id"])),{...e,method:"GET"})}static ListProducts(t,e){return s("/v1/products?".concat(d(t,[])),{...e,method:"GET"})}static DeleteProduct(t,e){return s("/v1/products/".concat(t.id),{...e,method:"DELETE"})}static UpdateProduct(t,e){return s("/v1/products/".concat(t.id),{...e,method:"PATCH",body:JSON.stringify(t,a)})}static ListPrompts(t,e){return s("/v1/prompts?".concat(d(t,[])),{...e,method:"GET"})}}}}]);
