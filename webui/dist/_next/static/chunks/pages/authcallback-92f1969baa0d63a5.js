(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[125],{9263:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/authcallback",function(){return r(9849)}])},9300:function(t,e,r){"use strict";function o(t){return t+".html"}r.d(e,{J:function(){return n}});let n={name:"NotionBoy",description:"NotionBoy is a note app base on Notion. It's a web app, you can use it in your browser.",links:{twitter:"https://twitter.com/LiuVaayne",github:"https://github.com/vaayne/NotionBoy",chatgpt:o("/chat"),login:o("/login"),home:"/",authCallback:o("/authcallback"),price:o("/price"),order:o("/order"),profile:o("/profile")},authPages:[o("/chat"),o("/order"),o("/user")]}},4157:function(t,e,r){"use strict";r.d(e,{t:function(){return d}});let o=Array(64),n=Array(123);for(let t=0;t<64;)n[o[t]=t<26?t+65:t<52?t+71:t<62?t-4:t-59|43]=t++;function s(t,e){return e&&e.constructor===Uint8Array?function(t,e,r){let n=null,s=[],a=0,i=0,c;for(;e<r;){let r=t[e++];switch(i){case 0:s[a++]=o[r>>2],c=(3&r)<<4,i=1;break;case 1:s[a++]=o[c|r>>4],c=(15&r)<<2,i=2;break;case 2:s[a++]=o[c|r>>6],s[a++]=o[63&r],i=0}a>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),a=0)}return(i&&(s[a++]=o[c],s[a++]=61,1===i&&(s[a++]=61)),n)?(a&&n.push(String.fromCharCode.apply(String,s.slice(0,a))),n.join("")):String.fromCharCode.apply(String,s.slice(0,a))}(e,0,e.length):e}function a(t,e){let{pathPrefix:r,...o}=e||{},n=r?"".concat(r).concat(t):t;return fetch(n,o).then(t=>t.json().then(e=>{if(!t.ok)throw e;return e}))}async function i(t,e,r){var o;let{pathPrefix:n,...s}=r||{},a=n?"".concat(n).concat(t):t,i=await fetch(a,s);if(!i.ok){let t=await i.json(),e=t.error&&t.error.message?t.error.message:"";throw Error(e)}if(!i.body)throw Error("response doesnt have a body");await i.body.pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({start(t){t.buf="",t.pos=0},transform(t,e){for(void 0===e.buf&&(e.buf=""),void 0===e.pos&&(e.pos=0),e.buf+=t;e.pos<e.buf.length;)if("\n"===e.buf[e.pos]){let t=e.buf.substring(0,e.pos),r=JSON.parse(t);e.enqueue(r.result),e.buf=e.buf.substring(e.pos+1),e.pos=0}else++e.pos}})).pipeTo((o=t=>{e&&e(t)},new WritableStream({write(t){o(t)}})))}function c(t){return["string","number","boolean"].some(e=>typeof t===e)}function u(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=function t(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.keys(e).reduce((o,n)=>{let s=e[n],a=r?[r,n].join("."):n,i=Array.isArray(s)&&s.every(t=>c(t))&&s.length>0,u=c(s)&&!(!1===s||0===s||""===s),d={};return!function(t){let e="Object"===Object.prototype.toString.call(t).slice(8,-1);if(!(null!==t&&e)||!e)return!1;let r=Object.getPrototypeOf(t),o="object"==typeof r&&r.constructor===Object.prototype.constructor;return o}(s)?(u||i)&&(d={[a]:s}):d=t(s,a),{...o,...d}},{})}(t),o=Object.keys(r).reduce((t,o)=>{let n=r[o];return e.find(t=>t===o)?t:Array.isArray(n)?[...t,...n.map(t=>[o,t.toString()])]:t=[...t,[o,n.toString()]]},[]);return new URLSearchParams(o).toString()}class d{static Status(t,e){return a("/v1/status?".concat(u(t,[])),{...e,method:"GET"})}static GenrateToken(t,e){return a("/v1/auth/token",{...e,method:"POST",body:JSON.stringify(t,s)})}static OAuthProviders(t,e){return a("/v1/auth/providers?".concat(u(t,[])),{...e,method:"GET"})}static OAuthCallback(t,e){return a("/v1/auth/callback",{...e,method:"POST",body:JSON.stringify(t,s)})}static GenerateApiKey(t,e){return a("/v1/auth/apikey",{...e,method:"POST"})}static DeleteApiKey(t,e){return a("/v1/auth/apikey",{...e,method:"DELETE"})}static GenerateWechatQRCode(t,e){return a("/v1/auth/wechat/qrcode",{...e,method:"POST",body:JSON.stringify(t,s)})}static CreateConversation(t,e){return a("/v1/conversations",{...e,method:"POST",body:JSON.stringify(t,s)})}static UpdateConversation(t,e){return a("/v1/conversations/".concat(t.id),{...e,method:"PUT",body:JSON.stringify(t,s)})}static GetConversation(t,e){return a("/v1/conversations/".concat(t.id,"?").concat(u(t,["id"])),{...e,method:"GET"})}static ListConversations(t,e){return a("/v1/conversations?".concat(u(t,[])),{...e,method:"GET"})}static DeleteConversation(t,e){return a("/v1/conversations/".concat(t.id),{...e,method:"DELETE"})}static CreateMessage(t,e,r){return i("/v1/conversations/".concat(t.conversationId,"/messages"),e,{...r,method:"POST",body:JSON.stringify(t,s)})}static GetMessage(t,e){return a("/v1/conversations/".concat(t.conversationId,"/messages/").concat(t.id,"?").concat(u(t,["conversationId","id"])),{...e,method:"GET"})}static ListMessages(t,e){return a("/v1/conversations/".concat(t.conversationId,"/messages?").concat(u(t,["conversationId"])),{...e,method:"GET"})}static DeleteMessage(t,e){return a("/v1/conversations/".concat(t.conversationId,"/messages/").concat(t.id),{...e,method:"DELETE"})}static CreateOrder(t,e){return a("/v1/orders",{...e,method:"POST",body:JSON.stringify(t,s)})}static GetOrder(t,e){return a("/v1/orders/".concat(t.id,"?").concat(u(t,["id"])),{...e,method:"GET"})}static ListOrders(t,e){return a("/v1/orders?".concat(u(t,[])),{...e,method:"GET"})}static DeleteOrder(t,e){return a("/v1/orders/".concat(t.id),{...e,method:"DELETE"})}static UpdateOrder(t,e){return a("/v1/orders/".concat(t.id),{...e,method:"PATCH",body:JSON.stringify(t,s)})}static PayOrder(t,e){return a("/v1/orders/".concat(t.id,"/pay"),{...e,method:"POST",body:JSON.stringify(t,s)})}static CreateProduct(t,e){return a("/internal/v1/products",{...e,method:"POST",body:JSON.stringify(t,s)})}static GetProduct(t,e){return a("/internal/v1/products/".concat(t.id,"?").concat(u(t,["id"])),{...e,method:"GET"})}static ListProducts(t,e){return a("/internal/v1/products?".concat(u(t,[])),{...e,method:"GET"})}static DeleteProduct(t,e){return a("/internal/v1/products/".concat(t.id),{...e,method:"DELETE"})}static UpdateProduct(t,e){return a("/internal/v1/products/".concat(t.id),{...e,method:"PATCH",body:JSON.stringify(t,s)})}}},9849:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return u}});var o=r(1527),n=r(9300),s=r(4157),a=r(6131),i=r(3125),c=r(959);function u(){let[t,e]=(0,c.useState)(!1),[r,u]=(0,c.useState)(!0),[d,l]=(0,c.useState)(""),h=(0,i.useRouter)();return(0,c.useEffect)(()=>{let t={code:h.query.code,state:h.query.state};if(!h.isReady){u(!0);return}console.log("req is in useEffect ".concat(JSON.stringify(t))),s.t.OAuthCallback(t).then(t=>{console.log("get token: ".concat(t)),t.token&&(a.Z.set("token",t.token,{expires:new Date(t.expiry)}),a.Z.set("tokenExpire",t.expiry,{expires:new Date(t.expiry)})),e(!0),h.push(n.J.links.home),u(!1)}).catch(t=>{console.log("Get token failed",t),l(t.message),u(!1)})},[h.isReady]),(0,o.jsx)("div",{className:"container mx-auto p-8 ",children:(0,o.jsxs)("article",{className:"prose prose-sm sm:prose lg:prose-lg xl:prose-2xl",children:[!r&&t&&(0,o.jsx)("h1",{children:"Redirecting..."}),!r&&!t&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{children:"Login Failed"}),(0,o.jsx)("div",{children:(0,o.jsxs)("p",{className:"text-red-500",children:[(0,o.jsx)("strong",{children:"Error Message:"})," ",d]})})]}),r&&(0,o.jsx)("h1",{children:"Validating..."})]})})}}},function(t){t.O(0,[774,888,179],function(){return t(t.s=9263)}),_N_E=t.O()}]);
