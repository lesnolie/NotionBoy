(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[125],{9263:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/authcallback",function(){return n(9849)}])},9300:function(t,e,n){"use strict";function r(t){return t+".html"}n.d(e,{J:function(){return o}});let o={name:"NotionBoy",description:"NotionBoy is a note app base on Notion. It's a web app, you can use it in your browser.",links:{twitter:"https://twitter.com/LiuVaayne",github:"https://github.com/vaayne/NotionBoy",chatgpt:r("/chat"),login:r("/login"),home:"/",authCallback:r("/authcallback")},authPages:[r("/chat")]}},4157:function(t,e,n){"use strict";n.d(e,{t:function(){return l}});let r=Array(64),o=Array(123);for(let t=0;t<64;)o[r[t]=t<26?t+65:t<52?t+71:t<62?t-4:t-59|43]=t++;function s(t,e){return e&&e.constructor===Uint8Array?function(t,e,n){let o=null,s=[],a=0,i=0,c;for(;e<n;){let n=t[e++];switch(i){case 0:s[a++]=r[n>>2],c=(3&n)<<4,i=1;break;case 1:s[a++]=r[c|n>>4],c=(15&n)<<2,i=2;break;case 2:s[a++]=r[c|n>>6],s[a++]=r[63&n],i=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return(i&&(s[a++]=r[c],s[a++]=61,1===i&&(s[a++]=61)),o)?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))}(e,0,e.length):e}function a(t,e){let{pathPrefix:n,...r}=e||{},o=n?"".concat(n).concat(t):t;return fetch(o,r).then(t=>t.json().then(e=>{if(!t.ok)throw e;return e}))}async function i(t,e,n){var r;let{pathPrefix:o,...s}=n||{},a=o?"".concat(o).concat(t):t,i=await fetch(a,s);if(!i.ok){let t=await i.json(),e=t.error&&t.error.message?t.error.message:"";throw Error(e)}if(!i.body)throw Error("response doesnt have a body");await i.body.pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({start(t){t.buf="",t.pos=0},transform(t,e){for(void 0===e.buf&&(e.buf=""),void 0===e.pos&&(e.pos=0),e.buf+=t;e.pos<e.buf.length;)if("\n"===e.buf[e.pos]){let t=e.buf.substring(0,e.pos),n=JSON.parse(t);e.enqueue(n.result),e.buf=e.buf.substring(e.pos+1),e.pos=0}else++e.pos}})).pipeTo((r=t=>{e&&e(t)},new WritableStream({write(t){r(t)}})))}function c(t){return["string","number","boolean"].some(e=>typeof t===e)}function u(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=function t(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.keys(e).reduce((r,o)=>{let s=e[o],a=n?[n,o].join("."):o,i=Array.isArray(s)&&s.every(t=>c(t))&&s.length>0,u=c(s)&&!(!1===s||0===s||""===s),l={};return!function(t){let e="Object"===Object.prototype.toString.call(t).slice(8,-1);if(!(null!==t&&e)||!e)return!1;let n=Object.getPrototypeOf(t),r="object"==typeof n&&n.constructor===Object.prototype.constructor;return r}(s)?(u||i)&&(l={[a]:s}):l=t(s,a),{...r,...l}},{})}(t),r=Object.keys(n).reduce((t,r)=>{let o=n[r];return e.find(t=>t===r)?t:Array.isArray(o)?[...t,...o.map(t=>[r,t.toString()])]:t=[...t,[r,o.toString()]]},[]);return new URLSearchParams(r).toString()}class l{static Status(t,e){return a("/v1/status?".concat(u(t,[])),{...e,method:"GET"})}static GenrateToken(t,e){return a("/v1/auth/token",{...e,method:"POST",body:JSON.stringify(t,s)})}static OAuthURL(t,e){return a("/v1/auth/url/".concat(t.provider,"?").concat(u(t,["provider"])),{...e,method:"GET"})}static OAuthCallback(t,e){return a("/v1/auth/callback",{...e,method:"POST",body:JSON.stringify(t,s)})}static GenerateApiKey(t,e){return a("/v1/auth/apikey",{...e,method:"POST"})}static DeleteApiKey(t,e){return a("/v1/auth/apikey",{...e,method:"DELETE"})}static CreateConversation(t,e){return a("/v1/conversations",{...e,method:"POST",body:JSON.stringify(t,s)})}static UpdateConversation(t,e){return a("/v1/conversations/".concat(t.id),{...e,method:"PUT",body:JSON.stringify(t,s)})}static GetConversation(t,e){return a("/v1/conversations/".concat(t.id,"?").concat(u(t,["id"])),{...e,method:"GET"})}static ListConversations(t,e){return a("/v1/conversations?".concat(u(t,[])),{...e,method:"GET"})}static DeleteConversation(t,e){return a("/v1/conversations/".concat(t.id),{...e,method:"DELETE"})}static CreateMessage(t,e,n){return i("/v1/conversations/".concat(t.conversationId,"/messages"),e,{...n,method:"POST",body:JSON.stringify(t,s)})}static GetMessage(t,e){return a("/v1/conversations/".concat(t.conversationId,"/messages/").concat(t.id,"?").concat(u(t,["conversationId","id"])),{...e,method:"GET"})}static ListMessages(t,e){return a("/v1/conversations/".concat(t.conversationId,"/messages?").concat(u(t,["conversationId"])),{...e,method:"GET"})}static DeleteMessage(t,e){return a("/v1/conversations/".concat(t.conversationId,"/messages/").concat(t.id),{...e,method:"DELETE"})}}},9849:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return u}});var r=n(1527),o=n(9300),s=n(4157),a=n(6131),i=n(3125),c=n(959);function u(){let[t,e]=(0,c.useState)(!1),[n,u]=(0,c.useState)(!0),[l,h]=(0,c.useState)(""),d=(0,i.useRouter)();return(0,c.useEffect)(()=>{let t={code:d.query.code,state:d.query.state};if(!d.isReady){u(!0);return}console.log("req is in useEffect ".concat(JSON.stringify(t))),s.t.OAuthCallback(t).then(t=>{console.log("get token: ".concat(t)),t.token&&(a.Z.set("token",t.token,{expires:new Date(t.expiry)}),a.Z.set("tokenExpire",t.expiry,{expires:new Date(t.expiry)})),e(!0),d.push(o.J.links.home),u(!1)}).catch(t=>{console.log("Get token failed",t),h(t.message),u(!1)})},[d.isReady]),(0,r.jsx)("div",{className:"container mx-auto p-8 ",children:(0,r.jsxs)("article",{className:"prose prose-sm sm:prose lg:prose-lg xl:prose-2xl",children:[!n&&t&&(0,r.jsx)("h1",{children:"Redirecting..."}),!n&&!t&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{children:"Login Failed"}),(0,r.jsx)("div",{children:(0,r.jsxs)("p",{className:"text-red-500",children:[(0,r.jsx)("strong",{children:"Error Message:"})," ",l]})})]}),n&&(0,r.jsx)("h1",{children:"Validating..."})]})})}}},function(t){t.O(0,[774,888,179],function(){return t(t.s=9263)}),_N_E=t.O()}]);
