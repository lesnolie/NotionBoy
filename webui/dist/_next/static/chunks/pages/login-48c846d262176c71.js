(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{4699:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return s(5828)}])},9423:function(e,t,s){"use strict";s.d(t,{$N:function(){return h},Be:function(){return p},Vq:function(){return o},cZ:function(){return f},fK:function(){return m},hg:function(){return c}});var a=s(1527),n=s(959),r=s(2084),l=s(8944),i=s(9140);let o=r.fC,c=r.xz,d=e=>{let{className:t,children:s,...n}=e;return(0,a.jsx)(r.h_,{className:(0,i.cn)(t),...n,children:(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-start justify-center sm:items-center",children:s})})};d.displayName=r.h_.displayName;let u=n.forwardRef((e,t)=>{let{className:s,children:n,...l}=e;return(0,a.jsx)(r.aV,{className:(0,i.cn)("fixed inset-0 z-50 bg-black/50 backdrop-blur-sm transition-all duration-100 data-[state=closed]:animate-out data-[state=open]:fade-in data-[state=closed]:fade-out",s),...l,ref:t})});u.displayName=r.aV.displayName;let f=n.forwardRef((e,t)=>{let{className:s,children:n,...o}=e;return(0,a.jsxs)(d,{children:[(0,a.jsx)(u,{}),(0,a.jsxs)(r.VY,{ref:t,className:(0,i.cn)("fixed z-50 grid w-full gap-4 rounded-b-lg bg-white p-6 animate-in data-[state=open]:fade-in-90 data-[state=open]:slide-in-from-bottom-10 sm:max-w-lg sm:rounded-lg sm:zoom-in-90 data-[state=open]:sm:slide-in-from-bottom-0","dark:bg-slate-900",s),...o,children:[n,(0,a.jsxs)(r.x8,{className:"absolute top-4 right-4 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-slate-100 dark:focus:ring-slate-400 dark:focus:ring-offset-slate-900 dark:data-[state=open]:bg-slate-800",children:[(0,a.jsx)(l.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=r.VY.displayName;let m=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...s})};m.displayName="DialogHeader";let x=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};x.displayName="DialogFooter";let h=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold text-slate-900","dark:text-slate-50",s),...n})});h.displayName=r.Dx.displayName;let p=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.dk,{ref:t,className:(0,i.cn)("text-sm text-slate-500","dark:text-slate-400",s),...n})});p.displayName=r.dk.displayName},4624:function(e,t,s){"use strict";s.d(t,{I:function(){return l}});var a=s(1527),n=s(959),r=s(9140);let l=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("input",{className:(0,r.cn)("flex h-10 w-full rounded-md border border-slate-300 bg-transparent py-2 px-3 text-sm placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-700 dark:text-slate-50 dark:focus:ring-slate-400 dark:focus:ring-offset-slate-900",s),ref:t,...n})});l.displayName="Input"},5828:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var a=s(1527),n=s(3933),r=s(4271),l=s(9423),i=s(4624),o=s(9300),c=s(4379),d=s(4157),u=s(6131),f=s(6380),m=s(7765),x=s.n(m),h=s(3125),p=s(959);function g(){let e=(0,h.useRouter)(),{toast:t}=(0,c.pm)(),[s,m]=(0,p.useState)(!1),[g,N]=(0,p.useState)(""),[j,w]=(0,p.useState)([]),[y,k]=(0,p.useState)("");(0,p.useEffect)(()=>{v(),s||d.t.OAuthProviders({}).then(e=>{w(e.providers)})},[]);let v=()=>{let e=u.Z.get(n.o3);if(void 0==e){m(!1);return}m(!0)},b=()=>{let s="";d.t.GenerateWechatQRCode({}).then(e=>{s=e.qrcode,k(e.url)}).catch(e=>{console.log("GenerateWechatQRCode error: ",e)});let a=setInterval(()=>{console.log("wechatQRCode: ".concat(s,", wechatQRCodeURL: ").concat(y)),d.t.GenrateToken({qrcode:s}).then(t=>{clearInterval(a),u.Z.set(n.o3,t.token),u.Z.set(n.kk,t.expiry),m(!0),e.push(o.J.links.home)}).catch(e=>{console.log("GenrateToken error: ",e)})},5e3);setTimeout(()=>{clearInterval(a),t({variant:"destructive",title:"Sign In error",description:"Sign In with QRCode timeout"})},3e5)};if(s)return e.push("/"),(0,a.jsx)("div",{className:"container flex flex-col items-center flex-grow p-8 mx-auto",children:(0,a.jsx)("div",{className:"m-4 prose",children:(0,a.jsx)("h1",{children:"You are already logged in!"})})});let C=s=>{d.t.GenrateToken({magicCode:s}).then(t=>{u.Z.set(n.o3,t.token),u.Z.set(n.kk,t.expiry),m(!0),e.push(o.J.links.home)}).catch(e=>{t({variant:"destructive",title:"Sign In with MagicCode error",description:JSON.stringify(e)})})};return(0,a.jsxs)("div",{className:"container flex flex-col items-center flex-grow p-8 mx-auto",children:[(0,a.jsx)("div",{className:"m-4 prose",children:(0,a.jsx)("h1",{children:"Please Login"})}),(0,a.jsxs)("div",{className:"container flex flex-col items-center max-w-sm mx-auto space-y-2 bg-white",children:[j.map(e=>void 0===e.url?(0,a.jsxs)(r.z,{disabled:!0,children:["Sign In with ",e.name]},e.name):(0,a.jsx)(x(),{href:e.url,className:"w-full",children:(0,a.jsxs)(r.z,{className:"w-full",children:["Sign In with ",e.name]})},e.name)),(0,a.jsxs)(l.Vq,{children:[(0,a.jsx)(l.hg,{onClick:()=>b(),asChild:!0,children:(0,a.jsx)(r.z,{className:"w-full",children:"微信扫码登录"})}),(0,a.jsxs)(l.cZ,{children:[(0,a.jsxs)(l.fK,{children:[(0,a.jsx)(l.$N,{children:"请扫描下方二维码进行登录"}),(0,a.jsx)(l.Be,{children:"需要先关注微信公众号"})]}),(0,a.jsx)("div",{className:"bg-indigo-300",children:(0,a.jsx)("img",{className:"object-cover w-full h-full ",src:y})})]})]}),(0,a.jsxs)(l.Vq,{children:[(0,a.jsx)(l.hg,{onClick:()=>b(),asChild:!0,children:(0,a.jsx)(r.z,{className:"w-full",children:"使用 MagicCode 登录"})}),(0,a.jsxs)(l.cZ,{children:[(0,a.jsxs)(l.fK,{children:[(0,a.jsx)(l.$N,{className:"prose",children:"使用微信或者 Telegram 获取 MagicCode"}),(0,a.jsx)(l.Be,{className:"prose",dangerouslySetInnerHTML:{__html:(0,f.TU)("微信搜索 **NotionBoy** 关注并回复 `/MagicCode`\n									<br />\n									OR\n									<br/>\n									Telegram 关注 [**NotionBoy**](https://t.me/TheNotionBoyBot) 并回复 `/MagicCode`\n									")}})]}),(0,a.jsxs)("div",{className:"flex items-center w-full max-w-sm space-x-2",children:[(0,a.jsx)(i.I,{type:"text",placeholder:"Sign In with MagicCode",value:g,onChange:e=>N(e.target.value)}),(0,a.jsx)(r.z,{type:"submit",onClick:()=>C(g),children:"Login"})]})]})]})]})]})}}},function(e){e.O(0,[593,84,380,933,774,888,179],function(){return e(e.s=4699)}),_N_E=e.O()}]);
